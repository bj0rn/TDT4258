\section{Description And Methodology}


\subsection{Initial Setup}
To begin with, peripherals such as buttons, LEDs, DAC, and timers needed to be configured. As C programs can control hardware directly, one only needs to use pointers to refer to memory-mapped I/O registers. A lot of these were provided in the efm32gg.h-file where many of the registers were defined with macros by using volatile uint32_t pointer variables, so in the initial setup it was simply a matter of dereferencing these and writing the appropriate values.


\subsubsection{Interrupt handlers}
The procedure for setting up interrupt handlers will vary depending on the hardware used. In this case, as the exception vectors were already filled out in the startup code, all that needed to be done to enable interrupt generation and interrupt handling was to write the appropriate value to the ISER0-register, whic was done in the setupNVIC()-function. The code for enabling interrupts for the GPIO-pins (odd and even) and TIMER1 was as follows. 

\begin{lstlisting}

void setupNVIC()
{
 	*ISER0 = 0x1802; /*Enable interrupt handling for odd and even GPIO pins and TIMER1*/
}

\end{lstlisting} 
This corresponds to writing bit 1, 11, and 12 in the register, which are the appropriate bits for enabling interrupts for the mentioned exception handlers.

\subsubsection{Hardware timers}
There are several hardware timers that can be used, depending on the purpose (calculation-intensive operations, low energy demnads, etc...). In the initial setup, 


\subsection{Sound Wave Synthesis}

Sound is realised through sound waves which is created by oscillations. "An oscillator generates a consistent, repeating signals". These consistent signals can be used to create waves at various frequencies. Sound is actually the properties of the waves generated, with respect to frequency, amplitude, and period. The frequency determines the tone of the sound, the amplitude the strength, and the period the duration of the sound.  

There are various different approaches for generating these sound waves. The different waves have slightly different properties in regard to sound. To name a few different waves we have the sine wave, sawtooth wave, triangle wave and the square wave. These waves produces different sound characteristics {\bf more on this ? Sources and shit like that}. 

In case of this assignment, we have crated two different kind of waves, the square wave and the sawtooth wave. The square wave is created by calculating discrete samples based on the tone frequency and the oscillator frequency. Oscillator frequency divided by the tone frequency decides how often the values to the DAC should alternate, thereby producing an approximation of the note. The different notes supported by the program is as follows, A, B, C, D, E, F, and H.



\subsection{Sound Sampling}
Sound can also be generated through pre computed samples. With this approach the sound waves are generated on some other platform. The samples produced are approximations to already existing sound samples. The samples are modified slightly to fit the microcontroller. Due to size limitations on the board, 8 bit samples with 8000Hz were generated. This allowed us to be able to play song with some length. In the first approach we generated samples with a sample frequency of 48000Hz. This sample rate produced sounds with relatively high sounds quality, but required a lot of storage for the songs. This limited the lenght of the songs we were able to play. 



\subsection{Energy Optimization}
In order to decrease the energy consumption of our program we have taken various different methods to reduce the consumption. Instead of using the proposed timer\cite{compendium}, we are instead using the low energy timer, LETIMER0 \cite{EFM32GG-rm}. This timer runs at a lower frequency, but require an low frequency oscillator in order to be of any value. The advantage with this timer is that it uses less energy and is able to run in EM2.  



\subsection{User Control}
\input{UserControl}











